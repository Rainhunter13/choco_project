[2021-01-22 04:37:04,291: INFO/MainProcess] Connected to redis://redis:6379/0
[2021-01-22 04:37:04,322: INFO/MainProcess] mingle: searching for neighbors
[2021-01-22 04:37:05,345: INFO/MainProcess] mingle: all alone
[2021-01-22 04:37:05,359: WARNING/MainProcess] /usr/local/lib/python3.6/site-packages/celery/fixups/django.py:204: UserWarning: Using settings.DEBUG leads to a memory
            leak, never use this setting in production environments!
  leak, never use this setting in production environments!''')

[2021-01-22 04:37:05,359: INFO/MainProcess] celery@1cee6d77e6a4 ready.
[2021-01-22 04:37:05,389: INFO/MainProcess] Received task: choco_project.celery.update[903fd6d2-f0e1-46b8-b754-354bae19f060]  
[2021-01-22 04:39:10,222: INFO/ForkPoolWorker-6] Task choco_project.celery.update_postgres_task[320e7ef5-23ee-44fe-b160-735ed6f131c6] succeeded in 124.8306298959942s: None
[2021-01-22 04:47:11,521: INFO/MainProcess] Received task: choco_project.celery.update[cfae3edc-bedc-4904-956a-6b776ca0150d]  
[2021-01-22 04:50:22,684: ERROR/ForkPoolWorker-6] Task choco_project.celery.unite_similar_products[f860ef4a-3c92-44df-ab6e-bc91df299631] raised unexpected: IndexError('list index out of range',)
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/celery/app/trace.py", line 405, in trace_task
    R = retval = fun(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/celery/app/trace.py", line 697, in __protected_call__
    return self.run(*args, **kwargs)
  File "/code/choco_project/celery.py", line 30, in unite_similar_products
    unite_similar_products()
  File "/code/myapi/services/updater.py", line 76, in unite_similar_products
    if from_same_shop(check_product, another_product):
  File "/code/myapi/services/updater.py", line 163, in from_same_shop
    if check_product_shops[i] and another_product_shops[i]:
IndexError: list index out of range
[2021-01-22 04:52:36,376: INFO/ForkPoolWorker-7] Task choco_project.celery.update_postgres_task[69453509-7ed6-48ef-9587-26a047cb7ff2] succeeded in 313.2043941860029s: None
[2021-01-22 05:02:20,007: INFO/MainProcess] Received task: choco_project.celery.update[0b80ca73-1236-4474-88de-795274c85fc7]  
[2021-01-22 05:03:43,937: ERROR/ForkPoolWorker-6] Task choco_project.celery.update_big_query_task[1ab2a41b-c77f-418f-bedc-15c03f353158] raised unexpected: GoogleAPICallError('POST https://bigquery.googleapis.com/bigquery/v2/projects/choco-big-query-2/datasets/products_dataset/tables/Product__22-01-2021--04-51-49/insertAll?prettyPrint=false: <!DOCTYPE html>\n<html lang=en>\n  <meta charset=utf-8>\n  <meta name=viewport content="initial-scale=1, minimum-scale=1, width=device-width">\n  <title>Error 408 (Request Timeout)!!1</title>\n  <style>\n    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png) no-repeat;margin-left:-5px}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:54px;width:150px}\n  </style>\n  <a href=//www.google.com/><span id=logo aria-label=Google></span></a>\n  <p><b>408.</b> <ins>That’s an error.</ins>\n  <p>Your client has taken too long to issue its request.  <ins>That’s all we know.</ins>\n',)
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/celery/app/trace.py", line 405, in trace_task
    R = retval = fun(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/celery/app/trace.py", line 697, in __protected_call__
    return self.run(*args, **kwargs)
  File "/code/choco_project/celery.py", line 37, in update_big_query_task
    update_big_query()
  File "/code/myapi/services/updater.py", line 146, in update_big_query
    client.insert_rows_json(new_table_id, rows_to_insert, row_ids=[None]*len(rows_to_insert))
  File "/usr/local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 3104, in insert_rows_json
    timeout=timeout,
  File "/usr/local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 643, in _call_api
    return call()
  File "/usr/local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/usr/local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.6/site-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.GoogleAPICallError: 408 POST https://bigquery.googleapis.com/bigquery/v2/projects/choco-big-query-2/datasets/products_dataset/tables/Product__22-01-2021--04-51-49/insertAll?prettyPrint=false: <!DOCTYPE html>
<html lang=en>
  <meta charset=utf-8>
  <meta name=viewport content="initial-scale=1, minimum-scale=1, width=device-width">
  <title>Error 408 (Request Timeout)!!1</title>
  <style>
    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}#logo{background:url(//www.google.com/images/branding/googlelogo/1x/googlelogo_color_150x54dp.png) no-repeat;margin-left:-5px}@media only screen and (min-resolution:192dpi){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat 0% 0%/100% 100%;-moz-border-image:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) 0}}@media only screen and (-webkit-min-device-pixel-ratio:2){#logo{background:url(//www.google.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png) no-repeat;-webkit-background-size:100% 100%}}#logo{display:inline-block;height:54px;width:150px}
  </style>
  <a href=//www.google.com/><span id=logo aria-label=Google></span></a>
  <p><b>408.</b> <ins>That’s an error.</ins>
  <p>Your client has taken too long to issue its request.  <ins>That’s all we know.</ins>

[2021-01-22 05:03:49,157: INFO/ForkPoolWorker-6] Task choco_project.celery.update[903fd6d2-f0e1-46b8-b754-354bae19f060] succeeded in 1604.2649264190113s: None
[2021-01-22 05:07:12,016: INFO/MainProcess] Received task: choco_project.celery.update[8d333023-5a80-4002-aa76-d167ff6ce6a7]  
[2021-01-22 05:09:12,796: ERROR/ForkPoolWorker-7] Task choco_project.celery.unite_similar_products[fe50c728-97c9-4400-9fb3-0ce56a921cd0] raised unexpected: IndexError('list index out of range',)
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/celery/app/trace.py", line 405, in trace_task
    R = retval = fun(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/celery/app/trace.py", line 697, in __protected_call__
    return self.run(*args, **kwargs)
  File "/code/choco_project/celery.py", line 30, in unite_similar_products
    unite_similar_products()
  File "/code/myapi/services/updater.py", line 76, in unite_similar_products
    if from_same_shop(check_product, another_product):
  File "/code/myapi/services/updater.py", line 163, in from_same_shop
    if check_product_shops[i] and another_product_shops[i]:
IndexError: list index out of range
[2021-01-22 05:09:35,389: INFO/ForkPoolWorker-6] Task choco_project.celery.update_postgres_task[e328e3c1-0334-4554-aef9-132d43bc7079] succeeded in 145.43960253000841s: None
[2021-01-22 05:09:38,186: INFO/ForkPoolWorker-8] Task choco_project.celery.update_postgres_task[cf9810d5-32d4-45d4-8b92-f0c775a355b6] succeeded in 398.6522776070051s: None
[2021-01-22 05:09:51,210: INFO/ForkPoolWorker-7] Task choco_project.celery.update_big_query_task[f626a2d1-1f76-49b0-a841-2685cde8bad2] succeeded in 38.6087937340053s: None
[2021-01-22 05:09:51,212: INFO/ForkPoolWorker-7] Task choco_project.celery.update[cfae3edc-bedc-4904-956a-6b776ca0150d] succeeded in 1350.883724801999s: None
[2021-01-22 05:10:27,450: WARNING/ForkPoolWorker-6] 5 out of the last 5 calls to <function recreate_function.<locals>.restored_function_body at 0x7f996a15df28> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[2021-01-22 05:10:39,330: ERROR/ForkPoolWorker-6] Task choco_project.celery.unite_similar_products[2f8b6100-071c-4166-a047-0f7b48be3b51] raised unexpected: KeyError('sulpak',)
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/celery/app/trace.py", line 405, in trace_task
    R = retval = fun(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/celery/app/trace.py", line 697, in __protected_call__
    return self.run(*args, **kwargs)
  File "/code/choco_project/celery.py", line 30, in unite_similar_products
    unite_similar_products()
  File "/code/myapi/services/updater.py", line 83, in unite_similar_products
    merge(check_product, another_product)
  File "/code/myapi/services/updater.py", line 183, in merge
    if check_product_shops[shop] is not None:
KeyError: 'sulpak'
[2021-01-22 05:10:39,407: WARNING/ForkPoolWorker-6] 6 out of the last 6 calls to <function recreate_function.<locals>.restored_function_body at 0x7f9968f35488> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[2021-01-22 05:11:00,644: ERROR/ForkPoolWorker-6] Task choco_project.celery.update_big_query_task[93630ce2-6693-4693-8338-f38a2a2c8c6c] raised unexpected: TransportError(ConnectionError(ProtocolError('Connection aborted.', RemoteDisconnected('Remote end closed connection without response',)),),)
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/urllib3/connectionpool.py", line 706, in urlopen
    chunked=chunked,
  File "/usr/local/lib/python3.6/site-packages/urllib3/connectionpool.py", line 445, in _make_request
    six.raise_from(e, None)
  File "<string>", line 3, in raise_from
  File "/usr/local/lib/python3.6/site-packages/urllib3/connectionpool.py", line 440, in _make_request
    httplib_response = conn.getresponse()
  File "/usr/local/lib/python3.6/http/client.py", line 1346, in getresponse
    response.begin()
  File "/usr/local/lib/python3.6/http/client.py", line 307, in begin
    version, status, reason = self._read_status()
  File "/usr/local/lib/python3.6/http/client.py", line 276, in _read_status
    raise RemoteDisconnected("Remote end closed connection without"
http.client.RemoteDisconnected: Remote end closed connection without response

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/usr/local/lib/python3.6/site-packages/urllib3/connectionpool.py", line 756, in urlopen
    method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]
  File "/usr/local/lib/python3.6/site-packages/urllib3/util/retry.py", line 531, in increment
    raise six.reraise(type(error), error, _stacktrace)
  File "/usr/local/lib/python3.6/site-packages/urllib3/packages/six.py", line 734, in reraise
    raise value.with_traceback(tb)
  File "/usr/local/lib/python3.6/site-packages/urllib3/connectionpool.py", line 706, in urlopen
    chunked=chunked,
  File "/usr/local/lib/python3.6/site-packages/urllib3/connectionpool.py", line 445, in _make_request
    six.raise_from(e, None)
  File "<string>", line 3, in raise_from
  File "/usr/local/lib/python3.6/site-packages/urllib3/connectionpool.py", line 440, in _make_request
    httplib_response = conn.getresponse()
  File "/usr/local/lib/python3.6/http/client.py", line 1346, in getresponse
    response.begin()
  File "/usr/local/lib/python3.6/http/client.py", line 307, in begin
    version, status, reason = self._read_status()
  File "/usr/local/lib/python3.6/http/client.py", line 276, in _read_status
    raise RemoteDisconnected("Remote end closed connection without"
urllib3.exceptions.ProtocolError: ('Connection aborted.', RemoteDisconnected('Remote end closed connection without response',))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/google/auth/transport/requests.py", line 183, in __call__
    method, url, data=body, headers=headers, timeout=timeout, **kwargs
  File "/usr/local/lib/python3.6/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
  File "/usr/local/lib/python3.6/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/requests/adapters.py", line 498, in send
    raise ConnectionError(err, request=request)
requests.exceptions.ConnectionError: ('Connection aborted.', RemoteDisconnected('Remote end closed connection without response',))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/celery/app/trace.py", line 405, in trace_task
    R = retval = fun(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/celery/app/trace.py", line 697, in __protected_call__
    return self.run(*args, **kwargs)
  File "/code/choco_project/celery.py", line 37, in update_big_query_task
    update_big_query()
  File "/code/myapi/services/updater.py", line 116, in update_big_query
    for table in client.list_tables(dataset_id):
  File "/usr/local/lib/python3.6/site-packages/google/api_core/page_iterator.py", line 212, in _items_iter
    for page in self._page_iter(increment=False):
  File "/usr/local/lib/python3.6/site-packages/google/api_core/page_iterator.py", line 243, in _page_iter
    page = self._next_page()
  File "/usr/local/lib/python3.6/site-packages/google/api_core/page_iterator.py", line 369, in _next_page
    response = self._get_next_page_response()
  File "/usr/local/lib/python3.6/site-packages/google/api_core/page_iterator.py", line 419, in _get_next_page_response
    method=self._HTTP_METHOD, path=self.path, query_params=params
  File "/usr/local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 1339, in api_request
    **kwargs,
  File "/usr/local/lib/python3.6/site-packages/google/cloud/bigquery/client.py", line 643, in _call_api
    return call()
  File "/usr/local/lib/python3.6/site-packages/google/api_core/retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "/usr/local/lib/python3.6/site-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.6/site-packages/google/cloud/_http.py", line 434, in api_request
    timeout=timeout,
  File "/usr/local/lib/python3.6/site-packages/google/cloud/_http.py", line 292, in _make_request
    method, url, headers, data, target_object, timeout=timeout
  File "/usr/local/lib/python3.6/site-packages/google/cloud/_http.py", line 330, in _do_request
    url=url, method=method, headers=headers, data=data, timeout=timeout
  File "/usr/local/lib/python3.6/site-packages/google/auth/transport/requests.py", line 460, in request
    self.credentials.before_request(auth_request, method, url, request_headers)
  File "/usr/local/lib/python3.6/site-packages/google/auth/credentials.py", line 133, in before_request
    self.refresh(request)
  File "/usr/local/lib/python3.6/site-packages/google/oauth2/service_account.py", line 361, in refresh
    access_token, expiry, _ = _client.jwt_grant(request, self._token_uri, assertion)
  File "/usr/local/lib/python3.6/site-packages/google/oauth2/_client.py", line 153, in jwt_grant
    response_data = _token_endpoint_request(request, token_uri, body)
  File "/usr/local/lib/python3.6/site-packages/google/oauth2/_client.py", line 105, in _token_endpoint_request
    response = request(method="POST", url=token_uri, headers=headers, body=body)
  File "/usr/local/lib/python3.6/site-packages/google/auth/transport/requests.py", line 188, in __call__
    six.raise_from(new_exc, caught_exc)
  File "<string>", line 3, in raise_from
google.auth.exceptions.TransportError: ('Connection aborted.', RemoteDisconnected('Remote end closed connection without response',))
[2021-01-22 05:11:00,645: INFO/ForkPoolWorker-6] Task choco_project.celery.update[8d333023-5a80-4002-aa76-d167ff6ce6a7] succeeded in 228.53183332300978s: None
[2021-01-22 05:15:57,928: ERROR/ForkPoolWorker-8] Task choco_project.celery.unite_similar_products[7c89a88e-0c4a-460c-adf4-47da0c134c05] raised unexpected: KeyError('sulpak',)
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/celery/app/trace.py", line 405, in trace_task
    R = retval = fun(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/celery/app/trace.py", line 697, in __protected_call__
    return self.run(*args, **kwargs)
  File "/code/choco_project/celery.py", line 30, in unite_similar_products
    unite_similar_products()
  File "/code/myapi/services/updater.py", line 83, in unite_similar_products
    merge(check_product, another_product)
  File "/code/myapi/services/updater.py", line 183, in merge
    if check_product_shops[shop] is not None:
KeyError: 'sulpak'
[2021-01-22 05:16:10,101: INFO/ForkPoolWorker-8] Task choco_project.celery.update_big_query_task[9f8f8aab-fca9-4732-8350-0c2b345966fb] succeeded in 11.990066618993296s: None
[2021-01-22 05:16:10,103: INFO/ForkPoolWorker-8] Task choco_project.celery.update[0b80ca73-1236-4474-88de-795274c85fc7] succeeded in 785.2523331590055s: None
[2021-01-22 05:17:28,070: INFO/MainProcess] Received task: choco_project.celery.update[cf2c68f4-5ee0-4dff-b00b-6704297c0b5c]  
[2021-01-22 05:19:35,327: INFO/ForkPoolWorker-6] Task choco_project.celery.update_postgres_task[e56df09d-b088-44d4-b7d4-0b70f699f969] succeeded in 127.2551916079974s: None
[2021-01-22 05:20:11,632: WARNING/ForkPoolWorker-6] 7 out of the last 7 calls to <function recreate_function.<locals>.restored_function_body at 0x7f996a09f378> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[2021-01-22 05:20:15,554: WARNING/ForkPoolWorker-6] 8 out of the last 8 calls to <function recreate_function.<locals>.restored_function_body at 0x7f99a4120840> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[2021-01-22 05:20:22,043: ERROR/ForkPoolWorker-6] Task choco_project.celery.unite_similar_products[5fe10ee8-20e7-4d07-b652-3eda078fbfa0] raised unexpected: KeyError('sulpak',)
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/celery/app/trace.py", line 405, in trace_task
    R = retval = fun(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/celery/app/trace.py", line 697, in __protected_call__
    return self.run(*args, **kwargs)
  File "/code/choco_project/celery.py", line 30, in unite_similar_products
    unite_similar_products()
  File "/code/myapi/services/updater.py", line 83, in unite_similar_products
    merge(check_product, another_product)
  File "/code/myapi/services/updater.py", line 183, in merge
    if check_product_shops[shop] is not None:
KeyError: 'sulpak'
[2021-01-22 05:20:22,149: WARNING/ForkPoolWorker-6] 9 out of the last 9 calls to <function recreate_function.<locals>.restored_function_body at 0x7f996b18b7b8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[2021-01-22 05:20:31,482: INFO/ForkPoolWorker-6] Task choco_project.celery.update_big_query_task[546dd3fc-6b3b-4aaa-be7d-14481f61acab] succeeded in 9.198574344001827s: None
[2021-01-22 05:20:31,483: INFO/ForkPoolWorker-6] Task choco_project.celery.update[cf2c68f4-5ee0-4dff-b00b-6704297c0b5c] succeeded in 183.41148203599732s: None
[2021-01-22 05:27:29,395: INFO/MainProcess] Received task: choco_project.celery.update[a4fa09b5-6f17-44e5-a554-f79cceef8745]  
[2021-01-22 05:28:31,290: INFO/ForkPoolWorker-6] Task choco_project.celery.update_postgres_task[d07449b3-0f94-49ae-9c12-68c8b827cbf9] succeeded in 61.89121575199533s: None
[2021-01-22 05:29:24,824: WARNING/ForkPoolWorker-6] 10 out of the last 10 calls to <function recreate_function.<locals>.restored_function_body at 0x7f996aa907b8> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[2021-01-22 05:29:26,730: WARNING/ForkPoolWorker-6] 11 out of the last 11 calls to <function recreate_function.<locals>.restored_function_body at 0x7f996a594b70> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[2021-01-22 05:29:48,216: ERROR/ForkPoolWorker-6] Task choco_project.celery.unite_similar_products[93cd5807-f232-4e51-bd24-3e1ca6842f14] raised unexpected: KeyError('sulpak',)
Traceback (most recent call last):
  File "/usr/local/lib/python3.6/site-packages/celery/app/trace.py", line 405, in trace_task
    R = retval = fun(*args, **kwargs)
  File "/usr/local/lib/python3.6/site-packages/celery/app/trace.py", line 697, in __protected_call__
    return self.run(*args, **kwargs)
  File "/code/choco_project/celery.py", line 30, in unite_similar_products
    unite_similar_products()
  File "/code/myapi/services/updater.py", line 83, in unite_similar_products
    merge(check_product, another_product)
  File "/code/myapi/services/updater.py", line 183, in merge
    for shop in SHOPS:
KeyError: 'sulpak'
[2021-01-22 05:29:48,301: WARNING/ForkPoolWorker-6] 11 out of the last 11 calls to <function recreate_function.<locals>.restored_function_body at 0x7f996a594730> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
[2021-01-22 05:29:57,197: INFO/ForkPoolWorker-6] Task choco_project.celery.update_big_query_task[f3d0fbfe-8638-4b2e-8ed3-23fa27864ed0] succeeded in 8.764675052007078s: None
[2021-01-22 05:29:57,199: INFO/ForkPoolWorker-6] Task choco_project.celery.update[a4fa09b5-6f17-44e5-a554-f79cceef8745] succeeded in 147.8006166460109s: None
[2021-01-22 05:32:20,511: INFO/MainProcess] Connected to redis://redis:6379/0
[2021-01-22 05:32:20,546: INFO/MainProcess] mingle: searching for neighbors
[2021-01-22 05:32:21,569: INFO/MainProcess] mingle: all alone
[2021-01-22 05:32:21,634: WARNING/MainProcess] /usr/local/lib/python3.6/site-packages/celery/fixups/django.py:204: UserWarning: Using settings.DEBUG leads to a memory
            leak, never use this setting in production environments!
  leak, never use this setting in production environments!''')

[2021-01-22 05:32:21,634: INFO/MainProcess] celery@1cee6d77e6a4 ready.
[2021-01-22 05:37:28,428: INFO/MainProcess] Received task: choco_project.celery.update[7c763015-9435-4ac2-b859-0868a475fb29]  
[2021-01-22 05:38:30,693: INFO/ForkPoolWorker-6] Task choco_project.celery.update_postgres_task[f0fdfd35-4528-4591-b690-9b52abbb4ae5] succeeded in 62.262802230994566s: None
[2021-01-22 05:39:20,590: INFO/ForkPoolWorker-6] Task choco_project.celery.unite_similar_products[7eb04222-2ed5-405a-866f-162255f52528] succeeded in 49.89445349999005s: None
[2021-01-22 05:39:34,965: INFO/ForkPoolWorker-6] Task choco_project.celery.update_big_query_task[e2f1fb54-4830-4e0f-b804-d757b8dc1de5] succeeded in 13.772982069989666s: None
[2021-01-22 05:39:34,968: INFO/ForkPoolWorker-6] Task choco_project.celery.update[7c763015-9435-4ac2-b859-0868a475fb29] succeeded in 126.53831155599619s: None
